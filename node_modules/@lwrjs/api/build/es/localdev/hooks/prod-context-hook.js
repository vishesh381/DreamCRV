import path from 'path';
import NormalizeRoutesStartHook from './normalize-routes-hook.js';
/**
 * Configuration that runs during the experimental-mrt-package command to setup CLWR hooks. Configures the
 * runtimeEnvironmentto reference the prod/* files in the MRT bundle and setup file watchers.
 */
export default class ProdStartHook {
    async setupServerContext(context, startHooks) {
        const { MRT_APP_CONFIG } = await import(path.join(process.cwd(), process.env.MRT_BUNDLE_ROOT ?? 'app', 'ssr.js'));
        Object.assign(context.routeHandlers, MRT_APP_CONFIG.routeHandlers);
        startHooks.push(...MRT_APP_CONFIG.hooks);
        startHooks.push(new NormalizeRoutesStartHook());
        // Watch files during package command
        context.runtimeEnvironment.watchFiles = true;
    }
}
//# sourceMappingURL=prod-context-hook.js.map